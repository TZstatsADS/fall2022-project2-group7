<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creating ZIP Code Choropleths with <em>choroplethrZip</em> • choroplethrZip</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Creating ZIP Code Choropleths with &lt;em&gt;choroplethrZip&lt;/em&gt;">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">choroplethrZip</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://www.arilamstein.com">Home</a>
</li>
<li>
  <a href="https://arilamstein.com/open-source/">Open Source</a>
</li>
<li>
  <a href="https://courses.arilamstein.com/">Courses</a>
</li>
<li>
  <a href="https://arilamstein.com/corporate-services/">Corporate Services</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/arilamstein/choroplethrZip">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Creating ZIP Code Choropleths with <em>choroplethrZip</em>
</h1>
                        <h4 class="author">Ari Lamstein</h4>
            
            <h4 class="date">April 16, 2015</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/arilamstein/choroplethrZip/blob/master/../site-documentation/vignettes/a-zip-choropleth.Rmd"><code>../site-documentation/vignettes/a-zip-choropleth.Rmd</code></a></small>
      <div class="hidden name"><code>a-zip-choropleth.Rmd</code></div>

    </div>

    
    
<!--
  %\VignetteEngine{knitr}
%\VignetteIndexEntry{a) US ZIP Choropleths}
-->
<p>You can create a choropleth of US ZIP codes with the function <code>zip_choropleth</code>. Note that what is rendered are actually US Zip Code Tabulated Areas (ZCTAs) from the US Census Bureau, not US Postal Service ZIP codes. <a href="https://www.census.gov/geo/reference/zctas.html">This page</a> from the Census Bureau explains the differences. See also <code><a href="../reference/zip.map.html">?zip.map</a></code> for more details.</p>
<p>Note that because of its size (~60MB) the <code>choroplethrZip</code> package is not hosted on CRAN. Rather, it is hosted on github <a href="https://github.com/arilamstein/choroplethrZip">here</a>. You can install the package by following the installation instructions on that page.</p>
<div id="data-requirements" class="section level1">
<h1 class="hasAnchor">
<a href="#data-requirements" class="anchor"></a>Data Requirements</h1>
<p>The data.frame that you provide to <code>zip_choropleth</code> must have one column named “region” and one column named “value”. Your entries for “region” must <strong>exactly</strong> match how regions are named in the map which choroplethr uses. These names are defined in the object <code>zip.regions</code> along with some useful metadata:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(choroplethrZip)

?zip.regions
<span class="kw">data</span>(zip.regions)
<span class="kw">head</span>(zip.regions)</code></pre></div>
<pre><code>##   region state.name county.name county.fips.numeric  cbsa cbsa.title
## 1  70560  louisiana      iberia               22045 10020       &lt;NA&gt;
## 2  70510  louisiana   vermilion               22113 10020       &lt;NA&gt;
## 3  70592  louisiana   lafayette               22055 10020       &lt;NA&gt;
## 4  70548  louisiana   vermilion               22113 10020       &lt;NA&gt;
## 5  70560  louisiana   vermilion               22113 10020       &lt;NA&gt;
## 6  70578  louisiana   lafayette               22055 10020       &lt;NA&gt;
##   metropolitan.micropolitan.statistical.area
## 1                                       &lt;NA&gt;
## 2                                       &lt;NA&gt;
## 3                                       &lt;NA&gt;
## 4                                       &lt;NA&gt;
## 5                                       &lt;NA&gt;
## 6                                       &lt;NA&gt;</code></pre>
<p>In order to use choroplethr, you must use the naming convention in the “region” column of zip.regions. That is, you must use the string version of the ZIP code - i.e. you must include any leading zeroes.</p>
</div>
<div id="exploring-data" class="section level1">
<h1 class="hasAnchor">
<a href="#exploring-data" class="anchor"></a>Exploring Data</h1>
<p>Like all choroplethr functions, <code>zip_choropleth</code> allows you to specify the scale with the <code>num_colors</code> parameter. What makes <code>zip_choropleth</code> unique is the number of zoom options. In addition to viewing all ZIPs in the country you can select ZIPs by State, County, Metropolitan Statistical Area (MSA) as well as manually specify a number of ZIPs.</p>
<div id="all-zctas-in-a-state" class="section level3">
<h3 class="hasAnchor">
<a href="#all-zctas-in-a-state" class="anchor"></a>All ZCTAs in a State</h3>
<p>Here is an example of viewing all ZCTAs in a State by using the <code>state_zoom</code> parameter:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(choroplethr)
<span class="kw">library</span>(choroplethrZip)

?df_pop_zip
<span class="kw">data</span>(df_pop_zip)

?zip_choropleth
<span class="kw"><a href="../reference/zip_choropleth.html">zip_choropleth</a></span>(df_pop_zip, 
               <span class="dt">state_zoom=</span><span class="st">"new york"</span>, 
               <span class="dt">title=</span><span class="st">"2012 New York State ZCTA Population Estimates"</span>,
               <span class="dt">legend=</span><span class="st">"Population"</span>)</code></pre></div>
<p><img src="a-zip-choropleth_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div id="all-zctas-in-selected-counties" class="section level3">
<h3 class="hasAnchor">
<a href="#all-zctas-in-selected-counties" class="anchor"></a>All ZCTAs in Selected Counties</h3>
<p>Here is an example of using the <code>county_zoom</code> parameter to zoom in on the five Counties of New York City:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># New York City is comprised of 5 counties: Bronx, Kings (Brooklyn), New York (Manhattan), </span>
<span class="co"># Queens, Richmond (Staten Island). Their numeric FIPS codes are:</span>
nyc_fips =<span class="st"> </span><span class="kw">c</span>(<span class="dv">36005</span>, <span class="dv">36047</span>, <span class="dv">36061</span>, <span class="dv">36081</span>, <span class="dv">36085</span>)
<span class="kw"><a href="../reference/zip_choropleth.html">zip_choropleth</a></span>(df_pop_zip,
               <span class="dt">county_zoom=</span>nyc_fips,
               <span class="dt">title=</span><span class="st">"2012 New York City ZCTA Population Estimates"</span>,
               <span class="dt">legend=</span><span class="st">"Population"</span>)</code></pre></div>
<p><img src="a-zip-choropleth_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="manually-selecting-zctas" class="section level3">
<h3 class="hasAnchor">
<a href="#manually-selecting-zctas" class="anchor"></a>Manually Selecting ZCTAs</h3>
<p>Here is an example of using the <code>zip_zoom</code> parameter to manually select all ZCTAs in two neighborhoods in Manhattan:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">manhattan_les =<span class="st"> </span><span class="kw">c</span>(<span class="st">"10002"</span>, <span class="st">"10003"</span>, <span class="st">"10009"</span>)
manhattan_ues =<span class="st"> </span><span class="kw">c</span>(<span class="st">"10021"</span>, <span class="st">"10028"</span>, <span class="st">"10044"</span>, <span class="st">"10128"</span>)
<span class="kw"><a href="../reference/zip_choropleth.html">zip_choropleth</a></span>(df_pop_zip,
               <span class="dt">zip_zoom=</span><span class="kw">c</span>(manhattan_les, manhattan_ues),
               <span class="dt">title=</span><span class="st">"2012 Lower and Upper East Side ZCTA Population Estimates"</span>,
               <span class="dt">legend=</span><span class="st">"Population"</span>)</code></pre></div>
<p><img src="a-zip-choropleth_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="all-zctas-in-a-metropolitan-statistical-area-msa" class="section level3">
<h3 class="hasAnchor">
<a href="#all-zctas-in-a-metropolitan-statistical-area-msa" class="anchor"></a>All ZCTAs in a Metropolitan Statistical Area (MSA)</h3>
<p>Here is an example of using the <code>msa_zoom</code> parameter to zoom in on the entire New York Metropolitan Statistical Area (MSA):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/zip_choropleth.html">zip_choropleth</a></span>(df_pop_zip,
               <span class="dt">msa_zoom=</span><span class="st">"New York-Newark-Jersey City, NY-NJ-PA"</span>,
               <span class="dt">title=</span><span class="st">"2012 NY-Newark-Jersey City MSA</span><span class="ch">\n</span><span class="st">ZCTA Population Estimates"</span>,
               <span class="dt">legend=</span><span class="st">"Population"</span>)</code></pre></div>
<p><img src="a-zip-choropleth_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="all-zctas-in-the-usa" class="section level3">
<h3 class="hasAnchor">
<a href="#all-zctas-in-the-usa" class="anchor"></a>All ZCTAs in the USA</h3>
<p>Here is an example of viewing all ZCTAs in the country. While interesting to look at, this map has two problems: 1) it takes a few minutes to render and b) due to the large number (32,989) and irregular shape of ZCTAs, it can sometimes be hard to read. I have found that experimenting with the number of colors can be especially useful for this map.</p>
<p><img src="a-zip-choropleth_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div id="advanced-options" class="section level1">
<h1 class="hasAnchor">
<a href="#advanced-options" class="anchor"></a>Advanced Options</h1>
<p>Any customization outside the optional parameters presented above will require you to create a <code>ZipChoropleth</code> object. choroplethr uses <a href="https://github.com/wch/R6">R6</a> to take advantage of object-oriented programming. Here is an example of using the <code>ggplot2_scale</code> on the base Choropleth object to customize the palette used.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)

choro =<span class="st"> </span>ZipChoropleth<span class="op">$</span><span class="kw">new</span>(df_pop_zip)
choro<span class="op">$</span>title =<span class="st"> "2012 ZCTA Population Estimates"</span>
choro<span class="op">$</span>ggplot_scale =<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_brewer">scale_fill_brewer</a></span>(<span class="dt">name=</span><span class="st">"Population"</span>, <span class="dt">palette=</span><span class="dv">2</span>, <span class="dt">drop=</span><span class="ot">FALSE</span>)
choro<span class="op">$</span><span class="kw">set_zoom_zip</span>(<span class="dt">state_zoom=</span><span class="st">"new york"</span>, <span class="dt">county_zoom=</span><span class="ot">NULL</span>, <span class="dt">msa_zoom=</span><span class="ot">NULL</span>, <span class="dt">zip_zoom=</span><span class="ot">NULL</span>)
choro<span class="op">$</span><span class="kw">render</span>()</code></pre></div>
<p><img src="a-zip-choropleth_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data-requirements">Data Requirements</a></li>
      <li><a href="#exploring-data">Exploring Data</a></li>
      <li><a href="#advanced-options">Advanced Options</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ari Lamstein.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
